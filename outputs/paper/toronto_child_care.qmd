---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Thomas Fox
thanks: "Code and data are available at: https://github.com/ThomasWilliamFox/toronto_child_care"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
toc: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
library(here)
library(knitr)
library(tinytex)
```


# Introduction

You can and should cross-reference sections and sub-sections. 

The remainder of this paper is structured as follows(@citeR). @sec-data....


# Data {#sec-data}

Some of our data is of penguins (@fig-totalspots), from @palmerpenguins.

```{r}
#| label: tbl-initialdata
#| tbl-cap: Population under 15 years of age by ward
#| echo: false
#| warning: false

# read cleaned child care data
 census_childcare_data = read_csv(
  file = here("outputs/data/merged_ward_data.csv"),
  show_col_types = FALSE
)

#Referenced from https://github.com/christina-wei/INF3104-1-Covid-Clinics/blob/main/outputs/paper/covid_clinics.qmd

head(census_childcare_data, 6) |>
  kable(
    col.names = c("Ward Number", "0 - 4", "5 - 9", "10 - 14", "Average Household Income", "Median Household Income", "Total Child Care Spaces", "Total Population Under 15"),
    booktabs = TRUE
  )

```

```{r}
#| label: fig-totalspots
#| fig-cap: Total number of child-care spaces by ward
#| echo: false
#| warning: false

# read ward names
ward_names = read_csv(
  file = here("outputs/data/ward_names.csv"),
  show_col_types = FALSE
)

# turn ward_names into list for graph substitution with ward numbers 
ward_name_list <- as.list(ward_names$ward_name)

# substitute ward numbers for names
census_childcare_data <-
  census_childcare_data |>
  mutate(ward = as.character(ward))

for (x in 1:25) {
  census_childcare_data$ward[census_childcare_data$ward == x] = ward_name_list[[x]]
} 

# construct graph 
child_care_graph_1 <-
  census_childcare_data|>
  ggplot(aes(x = reorder(ward, 1:25), y = total_spots)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 7, angle = 45, vjust = 1, hjust=1))+
  labs(x = "Ward arranged by ward number", y = "Total child care spaces")

child_care_graph_1
```


Some of our data is of money (@fig-totalchildren), from @palmerpenguins.

```{r}
#| label: fig-totalchildren
#| fig-cap: Population under 15 years of age by ward
#| echo: false
#| warning: false

# read cleaned census data
census_data = read_csv(
  file = here("outputs/data/census_data.csv"),
  show_col_types = FALSE
)

# substitute ward numbers for names

for (x in 1:25) {
  census_data$ward[census_data$ward == x] = ward_name_list[[x]]
} 

# construct graph 
census_graph_population<-
  census_data|>
  ggplot(aes(x = reorder(ward, 1:25), y = pop_0_to_4 + pop_5_to_9 + pop_10_to_14)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 7, angle = 45, vjust = 1, hjust=1))+
  labs(x = "Ward arranged by ward number", y = "Population under 15 years old") 

census_graph_population
```

Some of our data is of money (@fig-avgincome), from @palmerpenguins.

```{r}
#| label: fig-avgincome
#| fig-cap: Average household income by ward
#| echo: false
#| warning: false

# Construct graph 
census_graph_income <-
  census_data |>
  ggplot(aes(x = reorder(ward, avg_hh_income), y = avg_hh_income)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 7, angle = 45, vjust = 1, hjust=1)) +
  labs(x = "Ward arranged by average household income", y = "Average household income")
census_graph_income
```

```{r}
#| label: fig-spacesbyincome
#| fig-cap: Number of child care spaces by ward (arranged by average income)
#| echo: false
#| warning: false

spaces_by_ward <- 
  census_childcare_data|>
  ggplot(aes(x = reorder(ward, avg_hh_income), y = total_spots)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 7, angle = 45, vjust = 1, hjust=1)) +
  labs(x = "Ward arranged by average household income", y = "Child care spaces")

spaces_by_ward
```

```{r}
#| label: fig-childrenspacesplot
#| fig-cap: Number of children per child care space by ward
#| echo: false
#| warning: false

census_childcare_by_income <-
  arrange(census_childcare_data, avg_hh_income)


children_per_space_by_income <- 
  census_childcare_by_income |>
# Change the point size, and shape
  ggplot(aes(x=reorder(ward, avg_hh_income), y= total_under_15/total_spots)) +
  geom_point(fill= "black", size=1, shape=23) +
  geom_smooth(mapping = aes(x=1:25, y = total_under_15/total_spots), method=lm, se=FALSE) +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 7, angle = 45, vjust = 1, hjust=1)) +
  labs(x = "Ward arranged by average household income ", y = "Children per child care space") 

suppressMessages(print(children_per_space_by_income))
```


Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)


Talk way more about it. 

# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details



## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...




\newpage


# References


